<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A lock-free pagecache which supports fragmented pages for dramatically improving write throughput."><title>PageCache in pagecache - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../static.files/rustdoc-42caa33d.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="pagecache" data-themes="" data-resource-suffix="" data-rustdoc-version="1.84.0-nightly (90ab8eaed 2024-11-14)" data-channel="nightly" data-search-js="search-6851d9ab.js" data-settings-js="settings-0f613d39.js" ><script src="../static.files/storage-59e33391.js"></script><script defer src="sidebar-items.js"></script><script defer src="../static.files/main-5f194d8c.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-893ab5e7.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-6580c154.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-044be391.svg"></head><body class="rustdoc struct"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../pagecache/index.html">pagecache</a><span class="version">0.19.4</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Page<wbr>Cache</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#working-with-the-pagecache" title="Working with the `PageCache`">Working with the <code>PageCache</code></a></li></ul><h3><a href="#implementations">Methods</a></h3><ul class="block method"><li><a href="#method.allocate" title="allocate">allocate</a></li><li><a href="#method.attempt_gc" title="attempt_gc">attempt_gc</a></li><li><a href="#method.cas_root_in_meta" title="cas_root_in_meta">cas_root_in_meta</a></li><li><a href="#method.flush" title="flush">flush</a></li><li><a href="#method.free" title="free">free</a></li><li><a href="#method.generate_id" title="generate_id">generate_id</a></li><li><a href="#method.get" title="get">get</a></li><li><a href="#method.link" title="link">link</a></li><li><a href="#method.make_stable" title="make_stable">make_stable</a></li><li><a href="#method.meta" title="meta">meta</a></li><li><a href="#method.meta_pid_for_name" title="meta_pid_for_name">meta_pid_for_name</a></li><li><a href="#method.pin_log" title="pin_log">pin_log</a></li><li><a href="#method.replace" title="replace">replace</a></li><li><a href="#method.stable_lsn" title="stable_lsn">stable_lsn</a></li><li><a href="#method.start" title="start">start</a></li><li><a href="#method.was_recovered" title="was_recovered">was_recovered</a></li></ul><h3><a href="#trait-implementations">Trait Implementations</a></h3><ul class="block trait-implementation"><li><a href="#impl-Debug-for-PageCache%3CP%3E" title="Debug">Debug</a></li><li><a href="#impl-Send-for-PageCache%3CP%3E" title="Send">Send</a></li><li><a href="#impl-Sync-for-PageCache%3CP%3E" title="Sync">Sync</a></li></ul><h3><a href="#synthetic-implementations">Auto Trait Implementations</a></h3><ul class="block synthetic-implementation"><li><a href="#impl-Freeze-for-PageCache%3CP%3E" title="!Freeze">!Freeze</a></li><li><a href="#impl-RefUnwindSafe-for-PageCache%3CP%3E" title="!RefUnwindSafe">!RefUnwindSafe</a></li><li><a href="#impl-UnwindSafe-for-PageCache%3CP%3E" title="!UnwindSafe">!UnwindSafe</a></li><li><a href="#impl-Unpin-for-PageCache%3CP%3E" title="Unpin">Unpin</a></li></ul><h3><a href="#blanket-implementations">Blanket Implementations</a></h3><ul class="block blanket-implementation"><li><a href="#impl-Any-for-T" title="Any">Any</a></li><li><a href="#impl-Borrow%3CT%3E-for-T" title="Borrow&#60;T&#62;">Borrow&#60;T&#62;</a></li><li><a href="#impl-BorrowMut%3CT%3E-for-T" title="BorrowMut&#60;T&#62;">BorrowMut&#60;T&#62;</a></li><li><a href="#impl-From%3CT%3E-for-T" title="From&#60;T&#62;">From&#60;T&#62;</a></li><li><a href="#impl-Into%3CU%3E-for-T" title="Into&#60;U&#62;">Into&#60;U&#62;</a></li><li><a href="#impl-TryFrom%3CU%3E-for-T" title="TryFrom&#60;U&#62;">TryFrom&#60;U&#62;</a></li><li><a href="#impl-TryInto%3CU%3E-for-T" title="TryInto&#60;U&#62;">TryInto&#60;U&#62;</a></li></ul></section><div id="rustdoc-modnav"><h2 class="in-crate"><a href="index.html">In crate pagecache</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><span class="rustdoc-breadcrumbs"><a href="index.html">pagecache</a></span><h1>Struct <span class="struct">PageCache</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../src/pagecache/pagecache.rs.html#197-213">Source</a> </span></div><pre class="rust item-decl"><code>pub struct PageCache&lt;P&gt;<div class="where">where
    P: <a class="trait" href="trait.Materializer.html" title="trait pagecache::Materializer">Materializer</a>,</div>{ <span class="comment">/* private fields */</span> }</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A lock-free pagecache which supports fragmented pages
for dramatically improving write throughput.</p>
<h2 id="working-with-the-pagecache"><a class="doc-anchor" href="#working-with-the-pagecache">§</a>Working with the <code>PageCache</code></h2>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>{
    pagecache::{pin, Config, Materializer},
    serde::{Deserialize, Serialize},
};

<span class="attr">#[derive(
    Clone, Eq, PartialEq, Ord, PartialOrd, Debug, Serialize, Deserialize,
)]
</span><span class="kw">pub struct </span>TestState(String);

<span class="kw">impl </span>Materializer <span class="kw">for </span>TestState {
    <span class="comment">// Used to merge chains of partial pages into a form
    // that is useful for the `PageCache` owner.
    </span><span class="kw">fn </span>merge(<span class="kw-2">&amp;mut </span><span class="self">self</span>, other: <span class="kw-2">&amp;</span>TestState) {
        <span class="self">self</span>.<span class="number">0</span>.push_str(<span class="kw-2">&amp;</span>other.<span class="number">0</span>);
    }
}

<span class="kw">fn </span>main() {
    <span class="kw">let </span>config = pagecache::ConfigBuilder::new().temporary(<span class="bool-val">true</span>).build();
    <span class="kw">let </span>pc: pagecache::PageCache&lt;TestState&gt; =
        pagecache::PageCache::start(config).unwrap();
    {
        <span class="comment">// We begin by initiating a new transaction, which
        // will prevent any witnessable memory from being
        // reclaimed before we drop this object.
        </span><span class="kw">let </span>guard = pin();

        <span class="comment">// The first item in a page should be set using allocate,
        // which signals that this is the beginning of a new
        // page history.
        </span><span class="kw">let </span>(id, <span class="kw-2">mut </span>key) =
            pc.allocate(TestState(<span class="string">"a"</span>.to_owned()), <span class="kw-2">&amp;</span>guard).unwrap();

        <span class="comment">// Subsequent atomic updates should be added with link.
        </span>key = pc
            .link(id, key, TestState(<span class="string">"b"</span>.to_owned()), <span class="kw-2">&amp;</span>guard)
            .unwrap()
            .unwrap();
        key = pc
            .link(id, key, TestState(<span class="string">"c"</span>.to_owned()), <span class="kw-2">&amp;</span>guard)
            .unwrap()
            .unwrap();

        <span class="comment">// When getting a page, the provided `Materializer` is
        // used to merge all pages together.
        </span><span class="kw">let </span>(<span class="kw-2">mut </span>key, page, size_on_disk) =
            pc.get(id, <span class="kw-2">&amp;</span>guard).unwrap().unwrap();

        <span class="macro">assert_eq!</span>(page.<span class="number">0</span>, <span class="string">"abc"</span>.to_owned());

        <span class="comment">// You can completely rewrite a page by using `replace`:
        </span>key = pc
            .replace(id, key, TestState(<span class="string">"d"</span>.into()), <span class="kw-2">&amp;</span>guard)
            .unwrap()
            .unwrap();

        <span class="kw">let </span>(key, page, size_on_disk) =
            pc.get(id, <span class="kw-2">&amp;</span>guard).unwrap().unwrap();

        <span class="macro">assert_eq!</span>(page.<span class="number">0</span>, <span class="string">"d"</span>.to_owned());
    }
}</code></pre></div>
</div></details><h2 id="implementations" class="section-header">Implementations<a href="#implementations" class="anchor">§</a></h2><div id="implementations-list"><details class="toggle implementors-toggle" open><summary><section id="impl-PageCache%3CP%3E" class="impl"><a class="src rightside" href="../src/pagecache/pagecache.rs.html#277-1904">Source</a><a href="#impl-PageCache%3CP%3E" class="anchor">§</a><h3 class="code-header">impl&lt;P&gt; <a class="struct" href="struct.PageCache.html" title="struct pagecache::PageCache">PageCache</a>&lt;P&gt;<div class="where">where
    P: <a class="trait" href="trait.Materializer.html" title="trait pagecache::Materializer">Materializer</a>,</div></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.start" class="method"><a class="src rightside" href="../src/pagecache/pagecache.rs.html#282-427">Source</a><h4 class="code-header">pub fn <a href="#method.start" class="fn">start</a>(config: <a class="struct" href="struct.Config.html" title="struct pagecache::Config">Config</a>) -&gt; <a class="type" href="type.Result.html" title="type pagecache::Result">Result</a>&lt;Self&gt;</h4></section></summary><div class="docblock"><p>Instantiate a new <code>PageCache</code>.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.flush" class="method"><a class="src rightside" href="../src/pagecache/pagecache.rs.html#431-433">Source</a><h4 class="code-header">pub fn <a href="#method.flush" class="fn">flush</a>(&amp;self) -&gt; <a class="type" href="type.Result.html" title="type pagecache::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;</h4></section></summary><div class="docblock"><p>Flushes any pending IO buffers to disk to ensure durability.
Returns the number of bytes written during this call.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.allocate" class="method"><a class="src rightside" href="../src/pagecache/pagecache.rs.html#439-445">Source</a><h4 class="code-header">pub fn <a href="#method.allocate" class="fn">allocate</a>&lt;'g&gt;(
    &amp;self,
    new: P,
    guard: &amp;'g <a class="struct" href="struct.Guard.html" title="struct pagecache::Guard">Guard</a>,
) -&gt; <a class="type" href="type.Result.html" title="type pagecache::Result">Result</a>&lt;(<a class="type" href="type.PageId.html" title="type pagecache::PageId">PageId</a>, <a class="struct" href="struct.PagePtr.html" title="struct pagecache::PagePtr">PagePtr</a>&lt;'g, P&gt;)&gt;</h4></section></summary><div class="docblock"><p>Create a new page, trying to reuse old freed pages if possible
to maximize underlying <code>PageTable</code> pointer density. Returns
the page ID and its pointer for use in future atomic <code>replace</code>
and <code>link</code> operations.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.attempt_gc" class="method"><a class="src rightside" href="../src/pagecache/pagecache.rs.html#453-466">Source</a><h4 class="code-header">pub fn <a href="#method.attempt_gc" class="fn">attempt_gc</a>(&amp;self) -&gt; <a class="type" href="type.Result.html" title="type pagecache::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a>&gt;</h4></section></summary><div class="docblock"><p>Attempt to opportunistically rewrite data from a Draining
segment of the file to help with space amplification.
Returns Ok(true) if we had the opportunity to attempt to
move a page. Returns Ok(false) if there were no pages
to GC. Returns an Err if we encountered an IO problem
while performing this GC.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.pin_log" class="method"><a class="src rightside" href="../src/pagecache/pagecache.rs.html#480-487">Source</a><h4 class="code-header">pub fn <a href="#method.pin_log" class="fn">pin_log</a>(&amp;self) -&gt; <a class="type" href="type.Result.html" title="type pagecache::Result">Result</a>&lt;<a class="struct" href="struct.RecoveryGuard.html" title="struct pagecache::RecoveryGuard">RecoveryGuard</a>&lt;'_&gt;&gt;</h4></section></summary><div class="docblock"><p>Initiate an atomic sequence of writes to the
underlying log. Returns a <code>RecoveryGuard</code> which,
when dropped, will record the current max reserved
LSN into an earlier log reservation. During recovery,
when we hit this early atomic LSN marker, if the
specified LSN is beyond the contiguous tip of the log,
we immediately halt recovery, preventing the recovery
of partial transactions or write batches. This is
a relatively low-level primitive that can be used
to facilitate transactions and write batches when
combined with a concurrency control system in another
component.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.free" class="method"><a class="src rightside" href="../src/pagecache/pagecache.rs.html#577-614">Source</a><h4 class="code-header">pub fn <a href="#method.free" class="fn">free</a>&lt;'g&gt;(
    &amp;self,
    pid: <a class="type" href="type.PageId.html" title="type pagecache::PageId">PageId</a>,
    old: <a class="struct" href="struct.PagePtr.html" title="struct pagecache::PagePtr">PagePtr</a>&lt;'g, P&gt;,
    guard: &amp;'g <a class="struct" href="struct.Guard.html" title="struct pagecache::Guard">Guard</a>,
) -&gt; <a class="type" href="type.Result.html" title="type pagecache::Result">Result</a>&lt;<a class="type" href="type.CasResult.html" title="type pagecache::CasResult">CasResult</a>&lt;'g, P, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;&gt;</h4></section></summary><div class="docblock"><p>Free a particular page.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.link" class="method"><a class="src rightside" href="../src/pagecache/pagecache.rs.html#620-805">Source</a><h4 class="code-header">pub fn <a href="#method.link" class="fn">link</a>&lt;'g&gt;(
    &amp;'g self,
    pid: <a class="type" href="type.PageId.html" title="type pagecache::PageId">PageId</a>,
    old: <a class="struct" href="struct.PagePtr.html" title="struct pagecache::PagePtr">PagePtr</a>&lt;'g, P&gt;,
    new: P,
    guard: &amp;'g <a class="struct" href="struct.Guard.html" title="struct pagecache::Guard">Guard</a>,
) -&gt; <a class="type" href="type.Result.html" title="type pagecache::Result">Result</a>&lt;<a class="type" href="type.CasResult.html" title="type pagecache::CasResult">CasResult</a>&lt;'g, P, P&gt;&gt;</h4></section></summary><div class="docblock"><p>Try to atomically add a <code>PageFrag</code> to the page.
Returns <code>Ok(new_key)</code> if the operation was successful. Returns
<code>Err(None)</code> if the page no longer exists. Returns
<code>Err(Some(actual_key))</code> if the atomic append fails.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.replace" class="method"><a class="src rightside" href="../src/pagecache/pagecache.rs.html#811-846">Source</a><h4 class="code-header">pub fn <a href="#method.replace" class="fn">replace</a>&lt;'g&gt;(
    &amp;self,
    pid: <a class="type" href="type.PageId.html" title="type pagecache::PageId">PageId</a>,
    old: <a class="struct" href="struct.PagePtr.html" title="struct pagecache::PagePtr">PagePtr</a>&lt;'g, P&gt;,
    new: P,
    guard: &amp;'g <a class="struct" href="struct.Guard.html" title="struct pagecache::Guard">Guard</a>,
) -&gt; <a class="type" href="type.Result.html" title="type pagecache::Result">Result</a>&lt;<a class="type" href="type.CasResult.html" title="type pagecache::CasResult">CasResult</a>&lt;'g, P, P&gt;&gt;</h4></section></summary><div class="docblock"><p>Replace an existing page with a different set of <code>PageFrag</code>s.
Returns <code>Ok(new_key)</code> if the operation was successful. Returns
<code>Err(None)</code> if the page no longer exists. Returns
<code>Err(Some(actual_key))</code> if the atomic swap fails.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.get" class="method"><a class="src rightside" href="../src/pagecache/pagecache.rs.html#1274-1444">Source</a><h4 class="code-header">pub fn <a href="#method.get" class="fn">get</a>&lt;'g&gt;(
    &amp;self,
    pid: <a class="type" href="type.PageId.html" title="type pagecache::PageId">PageId</a>,
    guard: &amp;'g <a class="struct" href="struct.Guard.html" title="struct pagecache::Guard">Guard</a>,
) -&gt; <a class="type" href="type.Result.html" title="type pagecache::Result">Result</a>&lt;<a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;(<a class="struct" href="struct.PagePtr.html" title="struct pagecache::PagePtr">PagePtr</a>&lt;'g, P&gt;, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;'g P</a>, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>)&gt;&gt;</h4></section></summary><div class="docblock"><p>Try to retrieve a page by its logical ID.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.stable_lsn" class="method"><a class="src rightside" href="../src/pagecache/pagecache.rs.html#1447-1449">Source</a><h4 class="code-header">pub fn <a href="#method.stable_lsn" class="fn">stable_lsn</a>(&amp;self) -&gt; <a class="type" href="type.Lsn.html" title="type pagecache::Lsn">Lsn</a></h4></section></summary><div class="docblock"><p>The highest known stable Lsn on disk.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.make_stable" class="method"><a class="src rightside" href="../src/pagecache/pagecache.rs.html#1455-1457">Source</a><h4 class="code-header">pub fn <a href="#method.make_stable" class="fn">make_stable</a>(&amp;self, lsn: <a class="type" href="type.Lsn.html" title="type pagecache::Lsn">Lsn</a>) -&gt; <a class="type" href="type.Result.html" title="type pagecache::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>&gt;</h4></section></summary><div class="docblock"><p>Blocks until the provided Lsn is stable on disk,
triggering necessary flushes in the process.
Returns the number of bytes written during
this call.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.was_recovered" class="method"><a class="src rightside" href="../src/pagecache/pagecache.rs.html#1469-1471">Source</a><h4 class="code-header">pub fn <a href="#method.was_recovered" class="fn">was_recovered</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a></h4></section></summary><div class="docblock"><p>Returns <code>true</code> if the database was
recovered from a previous process.
Note that database state is only
guaranteed to be present up to the
last call to <code>flush</code>! Otherwise state
is synced to disk periodically if the
<code>sync_every_ms</code> configuration option
is set to <code>Some(number_of_ms_between_syncs)</code>
or if the IO buffer gets filled to
capacity before being rotated.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.generate_id" class="method"><a class="src rightside" href="../src/pagecache/pagecache.rs.html#1481-1532">Source</a><h4 class="code-header">pub fn <a href="#method.generate_id" class="fn">generate_id</a>(&amp;self) -&gt; <a class="type" href="type.Result.html" title="type pagecache::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>&gt;</h4></section></summary><div class="docblock"><p>Generate a monotonic ID. Not guaranteed to be
contiguous. Written to disk every <code>idgen_persist_interval</code>
operations, followed by a blocking flush. During recovery, we
take the last recovered generated ID and add 2x
the <code>idgen_persist_interval</code> to it. While persisting, if the
previous persisted counter wasn’t synced to disk yet, we will do
a blocking flush to fsync the latest counter, ensuring
that we will never give out the same counter twice.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.meta" class="method"><a class="src rightside" href="../src/pagecache/pagecache.rs.html#1538-1540">Source</a><h4 class="code-header">pub fn <a href="#method.meta" class="fn">meta</a>&lt;'a&gt;(&amp;self, guard: &amp;'a <a class="struct" href="struct.Guard.html" title="struct pagecache::Guard">Guard</a>) -&gt; <a class="type" href="type.Result.html" title="type pagecache::Result">Result</a>&lt;&amp;'a <a class="struct" href="struct.Meta.html" title="struct pagecache::Meta">Meta</a>&gt;</h4></section></summary><div class="docblock"><p>Returns the current <code>Meta</code> map, which contains a convenient
mapping from identifiers to PageId’s that the <code>PageCache</code>
owner may use for storing metadata about their higher-level
collections.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.meta_pid_for_name" class="method"><a class="src rightside" href="../src/pagecache/pagecache.rs.html#1549-1560">Source</a><h4 class="code-header">pub fn <a href="#method.meta_pid_for_name" class="fn">meta_pid_for_name</a>(&amp;self, name: &amp;[<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>], guard: &amp;<a class="struct" href="struct.Guard.html" title="struct pagecache::Guard">Guard</a>) -&gt; <a class="type" href="type.Result.html" title="type pagecache::Result">Result</a>&lt;<a class="type" href="type.PageId.html" title="type pagecache::PageId">PageId</a>&gt;</h4></section></summary><div class="docblock"><p>Look up a PageId for a given identifier in the <code>Meta</code>
mapping. This is pretty cheap, but in some cases
you may prefer to maintain your own atomic references
to collection roots instead of relying on this. See
sled’s <code>Tree</code> root tracking for an example of
avoiding this in a lock-free way that handles
various race conditions.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="method.cas_root_in_meta" class="method"><a class="src rightside" href="../src/pagecache/pagecache.rs.html#1564-1608">Source</a><h4 class="code-header">pub fn <a href="#method.cas_root_in_meta" class="fn">cas_root_in_meta</a>&lt;'g&gt;(
    &amp;self,
    name: &amp;[<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>],
    old: <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="type" href="type.PageId.html" title="type pagecache::PageId">PageId</a>&gt;,
    new: <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="type" href="type.PageId.html" title="type pagecache::PageId">PageId</a>&gt;,
    guard: &amp;'g <a class="struct" href="struct.Guard.html" title="struct pagecache::Guard">Guard</a>,
) -&gt; <a class="type" href="type.Result.html" title="type pagecache::Result">Result</a>&lt;<a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>, <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="type" href="type.PageId.html" title="type pagecache::PageId">PageId</a>&gt;&gt;&gt;</h4></section></summary><div class="docblock"><p>Compare-and-swap the <code>Meta</code> mapping for a given
identifier.</p>
</div></details></div></details></div><h2 id="trait-implementations" class="section-header">Trait Implementations<a href="#trait-implementations" class="anchor">§</a></h2><div id="trait-implementations-list"><details class="toggle implementors-toggle" open><summary><section id="impl-Debug-for-PageCache%3CP%3E" class="impl"><a class="src rightside" href="../src/pagecache/pagecache.rs.html#219-233">Source</a><a href="#impl-Debug-for-PageCache%3CP%3E" class="anchor">§</a><h3 class="code-header">impl&lt;P&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/fmt/trait.Debug.html" title="trait core::fmt::Debug">Debug</a> for <a class="struct" href="struct.PageCache.html" title="struct pagecache::PageCache">PageCache</a>&lt;P&gt;<div class="where">where
    P: <a class="trait" href="trait.Materializer.html" title="trait pagecache::Materializer">Materializer</a>,</div></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.fmt" class="method trait-impl"><a class="src rightside" href="../src/pagecache/pagecache.rs.html#223-232">Source</a><a href="#method.fmt" class="anchor">§</a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/nightly/core/fmt/trait.Debug.html#tymethod.fmt" class="fn">fmt</a>(&amp;self, f: &amp;mut <a class="struct" href="https://doc.rust-lang.org/nightly/core/fmt/struct.Formatter.html" title="struct core::fmt::Formatter">Formatter</a>&lt;'_&gt;) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>, <a class="struct" href="https://doc.rust-lang.org/nightly/core/fmt/struct.Error.html" title="struct core::fmt::Error">Error</a>&gt;</h4></section></summary><div class='docblock'>Formats the value using the given formatter. <a href="https://doc.rust-lang.org/nightly/core/fmt/trait.Debug.html#tymethod.fmt">Read more</a></div></details></div></details><section id="impl-Send-for-PageCache%3CP%3E" class="impl"><a class="src rightside" href="../src/pagecache/pagecache.rs.html#215">Source</a><a href="#impl-Send-for-PageCache%3CP%3E" class="anchor">§</a><h3 class="code-header">impl&lt;P&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> for <a class="struct" href="struct.PageCache.html" title="struct pagecache::PageCache">PageCache</a>&lt;P&gt;<div class="where">where
    P: <a class="trait" href="trait.Materializer.html" title="trait pagecache::Materializer">Materializer</a>,</div></h3></section><section id="impl-Sync-for-PageCache%3CP%3E" class="impl"><a class="src rightside" href="../src/pagecache/pagecache.rs.html#217">Source</a><a href="#impl-Sync-for-PageCache%3CP%3E" class="anchor">§</a><h3 class="code-header">impl&lt;P&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a> for <a class="struct" href="struct.PageCache.html" title="struct pagecache::PageCache">PageCache</a>&lt;P&gt;<div class="where">where
    P: <a class="trait" href="trait.Materializer.html" title="trait pagecache::Materializer">Materializer</a>,</div></h3></section></div><h2 id="synthetic-implementations" class="section-header">Auto Trait Implementations<a href="#synthetic-implementations" class="anchor">§</a></h2><div id="synthetic-implementations-list"><section id="impl-Freeze-for-PageCache%3CP%3E" class="impl"><a href="#impl-Freeze-for-PageCache%3CP%3E" class="anchor">§</a><h3 class="code-header">impl&lt;P&gt; !<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Freeze.html" title="trait core::marker::Freeze">Freeze</a> for <a class="struct" href="struct.PageCache.html" title="struct pagecache::PageCache">PageCache</a>&lt;P&gt;</h3></section><section id="impl-RefUnwindSafe-for-PageCache%3CP%3E" class="impl"><a href="#impl-RefUnwindSafe-for-PageCache%3CP%3E" class="anchor">§</a><h3 class="code-header">impl&lt;P&gt; !<a class="trait" href="https://doc.rust-lang.org/nightly/core/panic/unwind_safe/trait.RefUnwindSafe.html" title="trait core::panic::unwind_safe::RefUnwindSafe">RefUnwindSafe</a> for <a class="struct" href="struct.PageCache.html" title="struct pagecache::PageCache">PageCache</a>&lt;P&gt;</h3></section><section id="impl-Unpin-for-PageCache%3CP%3E" class="impl"><a href="#impl-Unpin-for-PageCache%3CP%3E" class="anchor">§</a><h3 class="code-header">impl&lt;P&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Unpin.html" title="trait core::marker::Unpin">Unpin</a> for <a class="struct" href="struct.PageCache.html" title="struct pagecache::PageCache">PageCache</a>&lt;P&gt;</h3></section><section id="impl-UnwindSafe-for-PageCache%3CP%3E" class="impl"><a href="#impl-UnwindSafe-for-PageCache%3CP%3E" class="anchor">§</a><h3 class="code-header">impl&lt;P&gt; !<a class="trait" href="https://doc.rust-lang.org/nightly/core/panic/unwind_safe/trait.UnwindSafe.html" title="trait core::panic::unwind_safe::UnwindSafe">UnwindSafe</a> for <a class="struct" href="struct.PageCache.html" title="struct pagecache::PageCache">PageCache</a>&lt;P&gt;</h3></section></div><h2 id="blanket-implementations" class="section-header">Blanket Implementations<a href="#blanket-implementations" class="anchor">§</a></h2><div id="blanket-implementations-list"><details class="toggle implementors-toggle"><summary><section id="impl-Any-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/any.rs.html#138">Source</a><a href="#impl-Any-for-T" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/any/trait.Any.html" title="trait core::any::Any">Any</a> for T<div class="where">where
    T: 'static + ?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</div></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.type_id" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/any.rs.html#139">Source</a><a href="#method.type_id" class="anchor">§</a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/nightly/core/any/trait.Any.html#tymethod.type_id" class="fn">type_id</a>(&amp;self) -&gt; <a class="struct" href="https://doc.rust-lang.org/nightly/core/any/struct.TypeId.html" title="struct core::any::TypeId">TypeId</a></h4></section></summary><div class='docblock'>Gets the <code>TypeId</code> of <code>self</code>. <a href="https://doc.rust-lang.org/nightly/core/any/trait.Any.html#tymethod.type_id">Read more</a></div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-Borrow%3CT%3E-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/borrow.rs.html#209">Source</a><a href="#impl-Borrow%3CT%3E-for-T" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/borrow/trait.Borrow.html" title="trait core::borrow::Borrow">Borrow</a>&lt;T&gt; for T<div class="where">where
    T: ?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</div></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.borrow" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/borrow.rs.html#211">Source</a><a href="#method.borrow" class="anchor">§</a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/nightly/core/borrow/trait.Borrow.html#tymethod.borrow" class="fn">borrow</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;T</a></h4></section></summary><div class='docblock'>Immutably borrows from an owned value. <a href="https://doc.rust-lang.org/nightly/core/borrow/trait.Borrow.html#tymethod.borrow">Read more</a></div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-BorrowMut%3CT%3E-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/borrow.rs.html#217">Source</a><a href="#impl-BorrowMut%3CT%3E-for-T" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/borrow/trait.BorrowMut.html" title="trait core::borrow::BorrowMut">BorrowMut</a>&lt;T&gt; for T<div class="where">where
    T: ?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</div></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.borrow_mut" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/borrow.rs.html#218">Source</a><a href="#method.borrow_mut" class="anchor">§</a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/nightly/core/borrow/trait.BorrowMut.html#tymethod.borrow_mut" class="fn">borrow_mut</a>(&amp;mut self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;mut T</a></h4></section></summary><div class='docblock'>Mutably borrows from an owned value. <a href="https://doc.rust-lang.org/nightly/core/borrow/trait.BorrowMut.html#tymethod.borrow_mut">Read more</a></div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-From%3CT%3E-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#765">Source</a><a href="#impl-From%3CT%3E-for-T" class="anchor">§</a><h3 class="code-header">impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.From.html" title="trait core::convert::From">From</a>&lt;T&gt; for T</h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.from" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#768">Source</a><a href="#method.from" class="anchor">§</a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/nightly/core/convert/trait.From.html#tymethod.from" class="fn">from</a>(t: T) -&gt; T</h4></section></summary><div class="docblock"><p>Returns the argument unchanged.</p>
</div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-Into%3CU%3E-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#748-750">Source</a><a href="#impl-Into%3CU%3E-for-T" class="anchor">§</a><h3 class="code-header">impl&lt;T, U&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;U&gt; for T<div class="where">where
    U: <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.From.html" title="trait core::convert::From">From</a>&lt;T&gt;,</div></h3></section></summary><div class="impl-items"><details class="toggle method-toggle" open><summary><section id="method.into" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#758">Source</a><a href="#method.into" class="anchor">§</a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/nightly/core/convert/trait.Into.html#tymethod.into" class="fn">into</a>(self) -&gt; U</h4></section></summary><div class="docblock"><p>Calls <code>U::from(self)</code>.</p>
<p>That is, this conversion is whatever the implementation of
<code><a href="https://doc.rust-lang.org/nightly/core/convert/trait.From.html" title="trait core::convert::From">From</a>&lt;T&gt; for U</code> chooses to do.</p>
</div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-TryFrom%3CU%3E-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#805-807">Source</a><a href="#impl-TryFrom%3CU%3E-for-T" class="anchor">§</a><h3 class="code-header">impl&lt;T, U&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;U&gt; for T<div class="where">where
    U: <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;T&gt;,</div></h3></section></summary><div class="impl-items"><details class="toggle" open><summary><section id="associatedtype.Error-1" class="associatedtype trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#809">Source</a><a href="#associatedtype.Error-1" class="anchor">§</a><h4 class="code-header">type <a href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html#associatedtype.Error" class="associatedtype">Error</a> = <a class="enum" href="https://doc.rust-lang.org/nightly/core/convert/enum.Infallible.html" title="enum core::convert::Infallible">Infallible</a></h4></section></summary><div class='docblock'>The type returned in the event of a conversion error.</div></details><details class="toggle method-toggle" open><summary><section id="method.try_from" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#812">Source</a><a href="#method.try_from" class="anchor">§</a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html#tymethod.try_from" class="fn">try_from</a>(value: U) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;T, &lt;T as <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;U&gt;&gt;::<a class="associatedtype" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a>&gt;</h4></section></summary><div class='docblock'>Performs the conversion.</div></details></div></details><details class="toggle implementors-toggle"><summary><section id="impl-TryInto%3CU%3E-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#790-792">Source</a><a href="#impl-TryInto%3CU%3E-for-T" class="anchor">§</a><h3 class="code-header">impl&lt;T, U&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryInto.html" title="trait core::convert::TryInto">TryInto</a>&lt;U&gt; for T<div class="where">where
    U: <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;,</div></h3></section></summary><div class="impl-items"><details class="toggle" open><summary><section id="associatedtype.Error" class="associatedtype trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#794">Source</a><a href="#associatedtype.Error" class="anchor">§</a><h4 class="code-header">type <a href="https://doc.rust-lang.org/nightly/core/convert/trait.TryInto.html#associatedtype.Error" class="associatedtype">Error</a> = &lt;U as <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;&gt;::<a class="associatedtype" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a></h4></section></summary><div class='docblock'>The type returned in the event of a conversion error.</div></details><details class="toggle method-toggle" open><summary><section id="method.try_into" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/nightly/src/core/convert/mod.rs.html#797">Source</a><a href="#method.try_into" class="anchor">§</a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/nightly/core/convert/trait.TryInto.html#tymethod.try_into" class="fn">try_into</a>(self) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;U, &lt;U as <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;&gt;::<a class="associatedtype" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a>&gt;</h4></section></summary><div class='docblock'>Performs the conversion.</div></details></div></details></div></section></div></main></body></html>