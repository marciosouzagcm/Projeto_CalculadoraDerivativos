<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Public-key authenticated encryption"><title>sodiumoxide::crypto::box_ - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../../static.files/rustdoc-42caa33d.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="sodiumoxide" data-themes="" data-resource-suffix="" data-rustdoc-version="1.84.0-nightly (90ab8eaed 2024-11-14)" data-channel="nightly" data-search-js="search-6851d9ab.js" data-settings-js="settings-0f613d39.js" ><script src="../../../static.files/storage-59e33391.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../../static.files/main-5f194d8c.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-893ab5e7.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-6580c154.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-044be391.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../sodiumoxide/index.html">sodiumoxide</a><span class="version">0.2.6</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module box_</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#security-model" title="Security model">Security model</a></li><li><a href="#selected-primitive" title="Selected primitive">Selected primitive</a></li><li><a href="#example-simple-interface" title="Example (simple interface)">Example (simple interface)</a></li><li><a href="#example-precomputation-interface" title="Example (precomputation interface)">Example (precomputation interface)</a></li></ul><h3><a href="#modules">Module Items</a></h3><ul class="block"><li><a href="#modules" title="Modules">Modules</a></li></ul></section><div id="rustdoc-modnav"><h2><a href="../index.html">In sodiumoxide::<wbr>crypto</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><span class="rustdoc-breadcrumbs"><a href="../../index.html">sodiumoxide</a>::<wbr><a href="../index.html">crypto</a></span><h1>Module <span>box_</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../src/sodiumoxide/crypto\box_/mod.rs.html#1-78">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Public-key authenticated encryption</p>
<h2 id="security-model"><a class="doc-anchor" href="#security-model">§</a>Security model</h2>
<p>The <code>seal()</code> function is designed to meet the standard notions of privacy and
third-party unforgeability for a public-key authenticated-encryption scheme
using nonces. For formal definitions see, e.g., Jee Hea An, “Authenticated
encryption in the public-key setting: security notions and analyses,”
<a href="http://eprint.iacr.org/2001/079">http://eprint.iacr.org/2001/079</a>.</p>
<p>Distinct messages between the same {sender, receiver} set are required
to have distinct nonces. For example, the lexicographically smaller
public key can use nonce 1 for its first message to the other key, nonce
3 for its second message, nonce 5 for its third message, etc., while the
lexicographically larger public key uses nonce 2 for its first message
to the other key, nonce 4 for its second message, nonce 6 for its third
message, etc. Nonces are long enough that randomly generated nonces have
negligible risk of collision.</p>
<p>There is no harm in having the same nonce for different messages if the
{sender, receiver} sets are different. This is true even if the sets
overlap. For example, a sender can use the same nonce for two different
messages if the messages are sent to two different public keys.</p>
<p>The <code>seal()</code> function is not meant to provide non-repudiation. On the
contrary: the <code>seal()</code> function guarantees repudiability. A receiver
can freely modify a boxed message, and therefore cannot convince third
parties that this particular message came from the sender. The sender
and receiver are nevertheless protected against forgeries by other
parties. In the terminology of
<a href="http://groups.google.com/group/sci.crypt/msg/ec5c18b23b11d82c">http://groups.google.com/group/sci.crypt/msg/ec5c18b23b11d82c</a>,
crypto_box uses “public-key authenticators” rather than “public-key
signatures.”</p>
<p>Users who want public verifiability (or receiver-assisted public
verifiability) should instead use signatures (or signcryption).
Signature support is a high priority for <code>NaCl</code>; a signature API will be
described in subsequent <code>NaCl</code> documentation.</p>
<h2 id="selected-primitive"><a class="doc-anchor" href="#selected-primitive">§</a>Selected primitive</h2>
<p><code>seal()</code> is <code>crypto_box_curve25519xsalsa20poly1305</code> , a particular
combination of Curve25519, Salsa20, and Poly1305 specified in
<a href="http://nacl.cr.yp.to/valid.html">Cryptography in <code>NaCl</code></a>.</p>
<p>This function is conjectured to meet the standard notions of privacy and
third-party unforgeability.</p>
<h2 id="example-simple-interface"><a class="doc-anchor" href="#example-simple-interface">§</a>Example (simple interface)</h2>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>sodiumoxide::crypto::box_;

<span class="kw">let </span>(ourpk, oursk) = box_::gen_keypair();
<span class="comment">// normally theirpk is sent by the other party
</span><span class="kw">let </span>(theirpk, theirsk) = box_::gen_keypair();
<span class="kw">let </span>nonce = box_::gen_nonce();
<span class="kw">let </span>plaintext = <span class="string">b"some data"</span>;
<span class="kw">let </span>ciphertext = box_::seal(plaintext, <span class="kw-2">&amp;</span>nonce, <span class="kw-2">&amp;</span>theirpk, <span class="kw-2">&amp;</span>oursk);
<span class="kw">let </span>their_plaintext = box_::open(<span class="kw-2">&amp;</span>ciphertext, <span class="kw-2">&amp;</span>nonce, <span class="kw-2">&amp;</span>ourpk, <span class="kw-2">&amp;</span>theirsk).unwrap();
<span class="macro">assert!</span>(plaintext == <span class="kw-2">&amp;</span>their_plaintext[..]);</code></pre></div>
<h2 id="example-precomputation-interface"><a class="doc-anchor" href="#example-precomputation-interface">§</a>Example (precomputation interface)</h2>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>sodiumoxide::crypto::box_;

<span class="kw">let </span>(ourpk, oursk) = box_::gen_keypair();
<span class="kw">let </span>(theirpk, theirsk) = box_::gen_keypair();
<span class="kw">let </span>our_precomputed_key = box_::precompute(<span class="kw-2">&amp;</span>theirpk, <span class="kw-2">&amp;</span>oursk);
<span class="kw">let </span>nonce = box_::gen_nonce();
<span class="kw">let </span>plaintext = <span class="string">b"plaintext"</span>;
<span class="kw">let </span>ciphertext = box_::seal_precomputed(plaintext, <span class="kw-2">&amp;</span>nonce, <span class="kw-2">&amp;</span>our_precomputed_key);
<span class="comment">// this will be identical to our_precomputed_key
</span><span class="kw">let </span>their_precomputed_key = box_::precompute(<span class="kw-2">&amp;</span>ourpk, <span class="kw-2">&amp;</span>theirsk);
<span class="kw">let </span>their_plaintext = box_::open_precomputed(<span class="kw-2">&amp;</span>ciphertext, <span class="kw-2">&amp;</span>nonce,
                                             <span class="kw-2">&amp;</span>their_precomputed_key).unwrap();
<span class="macro">assert!</span>(plaintext == <span class="kw-2">&amp;</span>their_plaintext[..]);</code></pre></div>
</div></details><h2 id="reexports" class="section-header">Re-exports<a href="#reexports" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><code>pub use self::<a class="mod" href="curve25519xsalsa20poly1305/index.html" title="mod sodiumoxide::crypto::box_::curve25519xsalsa20poly1305">curve25519xsalsa20poly1305</a>::*;</code></div></li></ul><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="curve25519xsalsa20poly1305/index.html" title="mod sodiumoxide::crypto::box_::curve25519xsalsa20poly1305">curve25519xsalsa20poly1305</a></div><div class="desc docblock-short"><code>crypto_box_curve25519xsalsa20poly1305</code> , a particular
combination of Curve25519, Salsa20, and Poly1305 specified in
<a href="http://nacl.cr.yp.to/valid.html">Cryptography in <code>NaCl</code></a>.</div></li></ul></section></div></main></body></html>