<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Prng contains a pseudo-random number generator."><title>soroban_sdk::prng - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../static.files/rustdoc-42caa33d.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="soroban_sdk" data-themes="" data-resource-suffix="" data-rustdoc-version="1.84.0-nightly (90ab8eaed 2024-11-14)" data-channel="nightly" data-search-js="search-6851d9ab.js" data-settings-js="settings-0f613d39.js" ><script src="../../static.files/storage-59e33391.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../static.files/main-5f194d8c.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-893ab5e7.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-6580c154.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-044be391.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../soroban_sdk/index.html">soroban_<wbr>sdk</a><span class="version">22.0.5</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module prng</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#warning" title="Warning">Warning</a></li><li><a href="#operation" title="Operation">Operation</a></li><li><a href="#testing" title="Testing">Testing</a></li></ul><h3><a href="#structs">Module Items</a></h3><ul class="block"><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#traits" title="Traits">Traits</a></li></ul></section><div id="rustdoc-modnav"><h2 class="in-crate"><a href="../index.html">In crate soroban_<wbr>sdk</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><span class="rustdoc-breadcrumbs"><a href="../index.html">soroban_sdk</a></span><h1>Module <span>prng</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../src/soroban_sdk/prng.rs.html#1-582">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Prng contains a pseudo-random number generator.</p>
<h3 id="warning"><a class="doc-anchor" href="#warning">§</a>Warning</h3>
<p>Do not use the PRNG in this module without a clear understanding of two
major limitations in the way it is deployed in the Stellar network:</p>
<ol>
<li>
<p>The PRNG is seeded with data that is public as soon as each ledger is
nominated. Therefore it <strong>should never be used to generate secrets</strong>.</p>
</li>
<li>
<p>The PRNG is seeded with data that is under the control of validators.
Therefore it <strong>should only be used in applications where the risk of
validator influence is acceptable</strong>.</p>
</li>
</ol>
<p>The PRNG in this module is a strong CSPRNG (ChaCha20) and can be manually
re-seeded by contracts, in order to support commit/reveal schemes, oracles,
or similar advanced types of pseudo-random contract behaviour. Any PRNG is
however only as strong as its seed.</p>
<p>The network runs in strict consensus, so every node in the network seeds its
PRNG with a consensus value, <strong>not a random entropy source</strong>. It uses data
that is generally difficult to predict in advance, and generally difficult
for network <strong>users</strong> to bias to a specific value: the seed is derived from
the overall transaction-set hash and the hash-sorted position number of each
transaction within it. But this seed is <strong>not secret</strong> and <strong>not
cryptographically hard to bias</strong> if a corrupt <strong>validator</strong> were to choose
to do so (similar to the way a corrupt validator can bias overall
transaction admission in the network).</p>
<p>In other words the network will provide a stronger seed than a contract
could likely derive on-chain using any other public data visible to it (eg.
better than using a timestamp, ledger number, counter, or a similarly weak
seed) but weaker than a contract could acquire using a commit/reveal scheme
with an off-chain source of trusted random entropy.</p>
<p>You should carefully consider whether these limitations are acceptable for
your application before using this module.</p>
<h3 id="operation"><a class="doc-anchor" href="#operation">§</a>Operation</h3>
<p>The host has a single hidden “base” PRNG that is seeded by the network. The
base PRNG is then used to seed separate, independent “local” PRNGs for each
contract invocation. This independence has the following characteristics:</p>
<ul>
<li>Contract invocations can only access (use or reseed) their local PRNG.</li>
<li>Contract invocations cannot influence any other invocation’s local PRNG,
except by influencing the other invocation to make a call to its PRNG.</li>
<li>Contracts cannot influence the base PRNG that seeds local PRNGs, except
by making calls and thereby creating new local PRNGs with new seeds.</li>
<li>A contract invocation’s local PRNG maintains state through the life of
the invocation.</li>
<li>That state is advanced by each call from the invocation to a PRNG
function in this module.</li>
<li>A contract invocation’s local PRNG is destroyed after the invocation.</li>
<li>Any re-entry of a contract counts as a separate invocation.</li>
</ul>
<h3 id="testing"><a class="doc-anchor" href="#testing">§</a>Testing</h3>
<p>In local tests, the base PRNG of each host is seeded to zero when the host
is constructed, so each contract invocation’s local PRNG seed (and all its
PRNG-derived calls) will be determined strictly by its order of invocation
in the test. Assuming this order is stable, each test run should see stable
output from the local PRNG.</p>
</div></details><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.Prng.html" title="struct soroban_sdk::prng::Prng">Prng</a></div><div class="desc docblock-short">Prng is a pseudo-random generator.</div></li></ul><h2 id="traits" class="section-header">Traits<a href="#traits" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="trait" href="trait.Fill.html" title="trait soroban_sdk::prng::Fill">Fill</a></div><div class="desc docblock-short">Implemented by types that support being filled by a Prng.</div></li><li><div class="item-name"><a class="trait" href="trait.Gen.html" title="trait soroban_sdk::prng::Gen">Gen</a></div><div class="desc docblock-short">Implemented by types that support being generated by a Prng.</div></li><li><div class="item-name"><a class="trait" href="trait.GenLen.html" title="trait soroban_sdk::prng::GenLen">GenLen</a></div><div class="desc docblock-short">Implemented by types that support being generated of specific length by a
Prng.</div></li><li><div class="item-name"><a class="trait" href="trait.GenRange.html" title="trait soroban_sdk::prng::GenRange">GenRange</a></div><div class="desc docblock-short">Implemented by types that support being generated in a specific range by a
Prng.</div></li><li><div class="item-name"><a class="trait" href="trait.Shuffle.html" title="trait soroban_sdk::prng::Shuffle">Shuffle</a></div><div class="desc docblock-short">Implemented by types that support being shuffled by a Prng.</div></li><li><div class="item-name"><a class="trait" href="trait.ToShuffled.html" title="trait soroban_sdk::prng::ToShuffled">ToShuffled</a></div><div class="desc docblock-short">Implemented by types that support being shuffled by a Prng.</div></li></ul></section></div></main></body></html>